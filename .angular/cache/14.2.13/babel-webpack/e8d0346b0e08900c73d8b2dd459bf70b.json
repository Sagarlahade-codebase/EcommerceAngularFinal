{"ast":null,"code":"import { loc, createCallout } from '../../../../../packages/@okta/courage-dist/esm/src/CourageForSigninWidget.js';\nimport '../../../../../packages/@okta/courage-dist/esm/lib/handlebars/dist/cjs/handlebars.runtime.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/handle-url.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-base64.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-i18n.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-img.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-markdown.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-xsrfTokenInput.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/framework/Model.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/vendor/lib/backbone.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/jquery-wrapper.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/underscore-wrapper.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/models/Model.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/models/BaseModel.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/framework/View.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/views/Backbone.ListView.js';\nimport '../../internals/BaseHeader.js';\nimport BaseFooter from '../../internals/BaseFooter.js';\nimport '../../internals/BaseForm.js';\nimport '../../internals/BaseFormWithPolling.js';\nimport Body$1 from '../../internals/BaseOktaVerifyChallengeView.js';\nimport BaseView from '../../internals/BaseView.js';\nimport '../../components/AuthenticatorEnrollOptions.js';\nimport '../../components/AuthenticatorVerifyOptions.js';\nimport '../../../../util/FactorUtil.js';\nimport Enums from '../../../../util/Enums.js';\nimport '../../../../v1/views/admin-consent/ScopeList.js';\nimport '../../../../v1/views/consent/ScopeList.js';\nimport '../captcha/CaptchaView.js';\nimport { CANCEL_POLLING_ACTION, IDENTIFIER_FLOW, AUTHENTICATION_CANCEL_REASONS } from '../../utils/Constants.js';\nimport Link from '../../components/Link.js';\nimport { doChallenge, cancelPollingWithParams } from '../../utils/ChallengeViewUtil.js';\nimport OktaVerifyAuthenticatorHeader from '../../components/OktaVerifyAuthenticatorHeader.js';\nimport { getSignOutLink } from '../../utils/LinksUtil.js';\nconst Body = Body$1.extend({\n  pollingCancelAction: CANCEL_POLLING_ACTION,\n  getDeviceChallengePayload: function () {\n    return this.options.currentViewState.relatesTo.value;\n  },\n  doChallenge: function () {\n    doChallenge(this, IDENTIFIER_FLOW);\n  },\n  onPollingFail: function () {\n    Body$1.prototype.onPollingFail.apply(this, arguments); // When SIW receives form error, polling is already stopped\n    // SIW needs to update footer link from /poll/cancel to /idp/idx/cancel\n\n    const data = {\n      label: loc('loopback.polling.cancel.link.with.form.error', 'login')\n    };\n    this.options.appState.trigger('updateFooterLink', data);\n  },\n  showCustomFormErrorCallout: function (error) {\n    const responseJSON = error.responseJSON;\n    const options = {\n      type: 'error',\n      className: 'okta-verify-uv-callout-content',\n      subtitle: responseJSON.errorSummary\n    };\n    const containsSignedNonceError = responseJSON.errorSummaryKeys && responseJSON.errorSummaryKeys.some(key => key.includes('auth.factor.signedNonce.error'));\n    if (containsSignedNonceError) {\n      options.title = loc('user.fail.verifyIdentity', 'login');\n    }\n    this.showMessages(createCallout(options));\n    return true;\n  }\n});\nconst Footer = BaseFooter.extend({\n  initialize: function () {\n    this.listenTo(this.options.appState, 'updateFooterLink', this.handleUpdateFooterLink);\n    if (this.isFallbackApproach() && !this.isFallbackDelayed()) {\n      BaseFooter.prototype.initialize.apply(this, arguments);\n    } else {\n      this.backLink = this.add(Link, {\n        options: {\n          name: 'cancel-authenticator-challenge',\n          label: loc('loopback.polling.cancel.link', 'login'),\n          clickHandler: () => {\n            cancelPollingWithParams(this.options.appState, CANCEL_POLLING_ACTION, AUTHENTICATION_CANCEL_REASONS.USER_CANCELED, null);\n          }\n        }\n      }).last();\n    }\n  },\n  handleUpdateFooterLink: function (data) {\n    // only update link for loopback\n    if (!this.isFallbackApproach() || this.isFallbackDelayed()) {\n      this.backLink && this.backLink.remove();\n      this.backLink = this.add(Link, {\n        options: getSignOutLink(this.options.settings, data)[0]\n      }).last();\n    }\n  },\n  isFallbackApproach: function () {\n    return [Enums.CUSTOM_URI_CHALLENGE, Enums.UNIVERSAL_LINK_CHALLENGE, Enums.APP_LINK_CHALLENGE].includes(this.options.currentViewState.relatesTo.value.challengeMethod);\n  },\n  isFallbackDelayed: function () {\n    // only delay showing the reopen Okta Verify button for the app link approach for now\n    // until we have more data shows other approaches have the slow cold start problem of the Okta Verify app as well\n    return this.options.currentViewState.relatesTo.value.challengeMethod === Enums.APP_LINK_CHALLENGE;\n  }\n});\nvar DeviceChallengePollView = BaseView.extend({\n  Header: OktaVerifyAuthenticatorHeader,\n  Body: Body,\n  Footer: Footer\n});\nexport { DeviceChallengePollView as default };","map":{"version":3,"names":["loc","createCallout","BaseFooter","Body$1","BaseView","Enums","CANCEL_POLLING_ACTION","IDENTIFIER_FLOW","AUTHENTICATION_CANCEL_REASONS","Link","doChallenge","cancelPollingWithParams","OktaVerifyAuthenticatorHeader","getSignOutLink","Body","extend","pollingCancelAction","getDeviceChallengePayload","options","currentViewState","relatesTo","value","onPollingFail","prototype","apply","arguments","data","label","appState","trigger","showCustomFormErrorCallout","error","responseJSON","type","className","subtitle","errorSummary","containsSignedNonceError","errorSummaryKeys","some","key","includes","title","showMessages","Footer","initialize","listenTo","handleUpdateFooterLink","isFallbackApproach","isFallbackDelayed","backLink","add","name","clickHandler","USER_CANCELED","last","remove","settings","CUSTOM_URI_CHALLENGE","UNIVERSAL_LINK_CHALLENGE","APP_LINK_CHALLENGE","challengeMethod","DeviceChallengePollView","Header","default"],"sources":["/Users/tushar/Desktop/fullstack-angular-and-springboot-master/source-code/ecommerce-project-release-3.0/09-security-order-history-secure-backend-and-frontend/03-frontend/angular-ecommerce/node_modules/@okta/okta-signin-widget/dist/esm/src/v2/view-builder/views/device/DeviceChallengePollView.js"],"sourcesContent":["import { loc, createCallout } from '../../../../../packages/@okta/courage-dist/esm/src/CourageForSigninWidget.js';\nimport '../../../../../packages/@okta/courage-dist/esm/lib/handlebars/dist/cjs/handlebars.runtime.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/handle-url.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-base64.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-i18n.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-img.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-markdown.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-xsrfTokenInput.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/framework/Model.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/vendor/lib/backbone.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/jquery-wrapper.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/underscore-wrapper.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/models/Model.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/models/BaseModel.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/framework/View.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/views/Backbone.ListView.js';\nimport '../../internals/BaseHeader.js';\nimport BaseFooter from '../../internals/BaseFooter.js';\nimport '../../internals/BaseForm.js';\nimport '../../internals/BaseFormWithPolling.js';\nimport Body$1 from '../../internals/BaseOktaVerifyChallengeView.js';\nimport BaseView from '../../internals/BaseView.js';\nimport '../../components/AuthenticatorEnrollOptions.js';\nimport '../../components/AuthenticatorVerifyOptions.js';\nimport '../../../../util/FactorUtil.js';\nimport Enums from '../../../../util/Enums.js';\nimport '../../../../v1/views/admin-consent/ScopeList.js';\nimport '../../../../v1/views/consent/ScopeList.js';\nimport '../captcha/CaptchaView.js';\nimport { CANCEL_POLLING_ACTION, IDENTIFIER_FLOW, AUTHENTICATION_CANCEL_REASONS } from '../../utils/Constants.js';\nimport Link from '../../components/Link.js';\nimport { doChallenge, cancelPollingWithParams } from '../../utils/ChallengeViewUtil.js';\nimport OktaVerifyAuthenticatorHeader from '../../components/OktaVerifyAuthenticatorHeader.js';\nimport { getSignOutLink } from '../../utils/LinksUtil.js';\n\nconst Body = Body$1.extend({\n  pollingCancelAction: CANCEL_POLLING_ACTION,\n  getDeviceChallengePayload: function () {\n    return this.options.currentViewState.relatesTo.value;\n  },\n  doChallenge: function () {\n    doChallenge(this, IDENTIFIER_FLOW);\n  },\n  onPollingFail: function () {\n    Body$1.prototype.onPollingFail.apply(this, arguments); // When SIW receives form error, polling is already stopped\n    // SIW needs to update footer link from /poll/cancel to /idp/idx/cancel\n\n    const data = {\n      label: loc('loopback.polling.cancel.link.with.form.error', 'login')\n    };\n    this.options.appState.trigger('updateFooterLink', data);\n  },\n  showCustomFormErrorCallout: function (error) {\n    const responseJSON = error.responseJSON;\n    const options = {\n      type: 'error',\n      className: 'okta-verify-uv-callout-content',\n      subtitle: responseJSON.errorSummary\n    };\n    const containsSignedNonceError = responseJSON.errorSummaryKeys && responseJSON.errorSummaryKeys.some(key => key.includes('auth.factor.signedNonce.error'));\n\n    if (containsSignedNonceError) {\n      options.title = loc('user.fail.verifyIdentity', 'login');\n    }\n\n    this.showMessages(createCallout(options));\n    return true;\n  }\n});\nconst Footer = BaseFooter.extend({\n  initialize: function () {\n    this.listenTo(this.options.appState, 'updateFooterLink', this.handleUpdateFooterLink);\n\n    if (this.isFallbackApproach() && !this.isFallbackDelayed()) {\n      BaseFooter.prototype.initialize.apply(this, arguments);\n    } else {\n      this.backLink = this.add(Link, {\n        options: {\n          name: 'cancel-authenticator-challenge',\n          label: loc('loopback.polling.cancel.link', 'login'),\n          clickHandler: () => {\n            cancelPollingWithParams(this.options.appState, CANCEL_POLLING_ACTION, AUTHENTICATION_CANCEL_REASONS.USER_CANCELED, null);\n          }\n        }\n      }).last();\n    }\n  },\n  handleUpdateFooterLink: function (data) {\n    // only update link for loopback\n    if (!this.isFallbackApproach() || this.isFallbackDelayed()) {\n      this.backLink && this.backLink.remove();\n      this.backLink = this.add(Link, {\n        options: getSignOutLink(this.options.settings, data)[0]\n      }).last();\n    }\n  },\n  isFallbackApproach: function () {\n    return [Enums.CUSTOM_URI_CHALLENGE, Enums.UNIVERSAL_LINK_CHALLENGE, Enums.APP_LINK_CHALLENGE].includes(this.options.currentViewState.relatesTo.value.challengeMethod);\n  },\n  isFallbackDelayed: function () {\n    // only delay showing the reopen Okta Verify button for the app link approach for now\n    // until we have more data shows other approaches have the slow cold start problem of the Okta Verify app as well\n    return this.options.currentViewState.relatesTo.value.challengeMethod === Enums.APP_LINK_CHALLENGE;\n  }\n});\nvar DeviceChallengePollView = BaseView.extend({\n  Header: OktaVerifyAuthenticatorHeader,\n  Body: Body,\n  Footer: Footer\n});\n\nexport { DeviceChallengePollView as default };\n"],"mappings":"AAAA,SAASA,GAAG,EAAEC,aAAa,QAAQ,8EAA8E;AACjH,OAAO,8FAA8F;AACrG,OAAO,0FAA0F;AACjG,OAAO,6FAA6F;AACpG,OAAO,2FAA2F;AAClG,OAAO,0FAA0F;AACjG,OAAO,+FAA+F;AACtG,OAAO,qGAAqG;AAC5G,OAAO,+EAA+E;AACtF,OAAO,mFAAmF;AAC1F,OAAO,mFAAmF;AAC1F,OAAO,uFAAuF;AAC9F,OAAO,4EAA4E;AACnF,OAAO,gFAAgF;AACvF,OAAO,8EAA8E;AACrF,OAAO,uFAAuF;AAC9F,OAAO,+BAA+B;AACtC,OAAOC,UAAU,MAAM,+BAA+B;AACtD,OAAO,6BAA6B;AACpC,OAAO,wCAAwC;AAC/C,OAAOC,MAAM,MAAM,gDAAgD;AACnE,OAAOC,QAAQ,MAAM,6BAA6B;AAClD,OAAO,gDAAgD;AACvD,OAAO,gDAAgD;AACvD,OAAO,gCAAgC;AACvC,OAAOC,KAAK,MAAM,2BAA2B;AAC7C,OAAO,iDAAiD;AACxD,OAAO,2CAA2C;AAClD,OAAO,2BAA2B;AAClC,SAASC,qBAAqB,EAAEC,eAAe,EAAEC,6BAA6B,QAAQ,0BAA0B;AAChH,OAAOC,IAAI,MAAM,0BAA0B;AAC3C,SAASC,WAAW,EAAEC,uBAAuB,QAAQ,kCAAkC;AACvF,OAAOC,6BAA6B,MAAM,mDAAmD;AAC7F,SAASC,cAAc,QAAQ,0BAA0B;AAEzD,MAAMC,IAAI,GAAGX,MAAM,CAACY,MAAM,CAAC;EACzBC,mBAAmB,EAAEV,qBAAqB;EAC1CW,yBAAyB,EAAE,SAAAA,CAAA,EAAY;IACrC,OAAO,IAAI,CAACC,OAAO,CAACC,gBAAgB,CAACC,SAAS,CAACC,KAAK;EACtD,CAAC;EACDX,WAAW,EAAE,SAAAA,CAAA,EAAY;IACvBA,WAAW,CAAC,IAAI,EAAEH,eAAe,CAAC;EACpC,CAAC;EACDe,aAAa,EAAE,SAAAA,CAAA,EAAY;IACzBnB,MAAM,CAACoB,SAAS,CAACD,aAAa,CAACE,KAAK,CAAC,IAAI,EAAEC,SAAS,CAAC,CAAC,CAAC;IACvD;;IAEA,MAAMC,IAAI,GAAG;MACXC,KAAK,EAAE3B,GAAG,CAAC,8CAA8C,EAAE,OAAO;IACpE,CAAC;IACD,IAAI,CAACkB,OAAO,CAACU,QAAQ,CAACC,OAAO,CAAC,kBAAkB,EAAEH,IAAI,CAAC;EACzD,CAAC;EACDI,0BAA0B,EAAE,SAAAA,CAAUC,KAAK,EAAE;IAC3C,MAAMC,YAAY,GAAGD,KAAK,CAACC,YAAY;IACvC,MAAMd,OAAO,GAAG;MACde,IAAI,EAAE,OAAO;MACbC,SAAS,EAAE,gCAAgC;MAC3CC,QAAQ,EAAEH,YAAY,CAACI;IACzB,CAAC;IACD,MAAMC,wBAAwB,GAAGL,YAAY,CAACM,gBAAgB,IAAIN,YAAY,CAACM,gBAAgB,CAACC,IAAI,CAACC,GAAG,IAAIA,GAAG,CAACC,QAAQ,CAAC,+BAA+B,CAAC,CAAC;IAE1J,IAAIJ,wBAAwB,EAAE;MAC5BnB,OAAO,CAACwB,KAAK,GAAG1C,GAAG,CAAC,0BAA0B,EAAE,OAAO,CAAC;IAC1D;IAEA,IAAI,CAAC2C,YAAY,CAAC1C,aAAa,CAACiB,OAAO,CAAC,CAAC;IACzC,OAAO,IAAI;EACb;AACF,CAAC,CAAC;AACF,MAAM0B,MAAM,GAAG1C,UAAU,CAACa,MAAM,CAAC;EAC/B8B,UAAU,EAAE,SAAAA,CAAA,EAAY;IACtB,IAAI,CAACC,QAAQ,CAAC,IAAI,CAAC5B,OAAO,CAACU,QAAQ,EAAE,kBAAkB,EAAE,IAAI,CAACmB,sBAAsB,CAAC;IAErF,IAAI,IAAI,CAACC,kBAAkB,CAAC,CAAC,IAAI,CAAC,IAAI,CAACC,iBAAiB,CAAC,CAAC,EAAE;MAC1D/C,UAAU,CAACqB,SAAS,CAACsB,UAAU,CAACrB,KAAK,CAAC,IAAI,EAAEC,SAAS,CAAC;IACxD,CAAC,MAAM;MACL,IAAI,CAACyB,QAAQ,GAAG,IAAI,CAACC,GAAG,CAAC1C,IAAI,EAAE;QAC7BS,OAAO,EAAE;UACPkC,IAAI,EAAE,gCAAgC;UACtCzB,KAAK,EAAE3B,GAAG,CAAC,8BAA8B,EAAE,OAAO,CAAC;UACnDqD,YAAY,EAAEA,CAAA,KAAM;YAClB1C,uBAAuB,CAAC,IAAI,CAACO,OAAO,CAACU,QAAQ,EAAEtB,qBAAqB,EAAEE,6BAA6B,CAAC8C,aAAa,EAAE,IAAI,CAAC;UAC1H;QACF;MACF,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC;IACX;EACF,CAAC;EACDR,sBAAsB,EAAE,SAAAA,CAAUrB,IAAI,EAAE;IACtC;IACA,IAAI,CAAC,IAAI,CAACsB,kBAAkB,CAAC,CAAC,IAAI,IAAI,CAACC,iBAAiB,CAAC,CAAC,EAAE;MAC1D,IAAI,CAACC,QAAQ,IAAI,IAAI,CAACA,QAAQ,CAACM,MAAM,CAAC,CAAC;MACvC,IAAI,CAACN,QAAQ,GAAG,IAAI,CAACC,GAAG,CAAC1C,IAAI,EAAE;QAC7BS,OAAO,EAAEL,cAAc,CAAC,IAAI,CAACK,OAAO,CAACuC,QAAQ,EAAE/B,IAAI,CAAC,CAAC,CAAC;MACxD,CAAC,CAAC,CAAC6B,IAAI,CAAC,CAAC;IACX;EACF,CAAC;EACDP,kBAAkB,EAAE,SAAAA,CAAA,EAAY;IAC9B,OAAO,CAAC3C,KAAK,CAACqD,oBAAoB,EAAErD,KAAK,CAACsD,wBAAwB,EAAEtD,KAAK,CAACuD,kBAAkB,CAAC,CAACnB,QAAQ,CAAC,IAAI,CAACvB,OAAO,CAACC,gBAAgB,CAACC,SAAS,CAACC,KAAK,CAACwC,eAAe,CAAC;EACvK,CAAC;EACDZ,iBAAiB,EAAE,SAAAA,CAAA,EAAY;IAC7B;IACA;IACA,OAAO,IAAI,CAAC/B,OAAO,CAACC,gBAAgB,CAACC,SAAS,CAACC,KAAK,CAACwC,eAAe,KAAKxD,KAAK,CAACuD,kBAAkB;EACnG;AACF,CAAC,CAAC;AACF,IAAIE,uBAAuB,GAAG1D,QAAQ,CAACW,MAAM,CAAC;EAC5CgD,MAAM,EAAEnD,6BAA6B;EACrCE,IAAI,EAAEA,IAAI;EACV8B,MAAM,EAAEA;AACV,CAAC,CAAC;AAEF,SAASkB,uBAAuB,IAAIE,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module"}
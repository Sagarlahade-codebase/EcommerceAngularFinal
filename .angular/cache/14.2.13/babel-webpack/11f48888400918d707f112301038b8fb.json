{"ast":null,"code":"import _asyncToGenerator from \"/Users/tushar/Desktop/fullstack-angular-and-springboot-master/source-code/ecommerce-project-release-3.0/09-security-order-history-secure-backend-and-frontend/03-frontend/angular-ecommerce/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport '../../../packages/@okta/courage-dist/esm/src/CourageForSigninWidget.js';\nimport '../../../packages/@okta/courage-dist/esm/lib/handlebars/dist/cjs/handlebars.runtime.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/handle-url.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-base64.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-i18n.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-img.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-markdown.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-xsrfTokenInput.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/framework/Model.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/vendor/lib/backbone.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/util/jquery-wrapper.js';\nimport oktaUnderscore from '../../../packages/@okta/courage-dist/esm/src/courage/util/underscore-wrapper.js';\nimport Model from '../../../packages/@okta/courage-dist/esm/src/courage/models/Model.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/models/BaseModel.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/framework/View.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/views/Backbone.ListView.js';\nimport Logger from '../../util/Logger.js';\nimport { FORMS_FOR_VERIFICATION, FORMS_WITHOUT_SIGNOUT, FORMS, FORMS_WITH_STATIC_BACK_LINK, AUTHENTICATOR_KEY } from '../ion/RemediationConstants.js';\nimport { createOVOptions } from '../ion/ui-schema/ion-object-handler.js';\nimport '../mixins/mixins.js';\nimport { executeHooksBefore, executeHooksAfter } from '../../util/Hooks.js';\n\n/*!\n * Copyright (c) 2020, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nconst UNKNOWN_USER_I8N_KEY = \"idx.unknown.user\";\n/**\n * Keep track of stateMachine with this special model. Similar to `src/models/AppState.js`\n */\n\nconst local = {\n  user: 'object',\n  // optional\n  currentFormName: 'string',\n  idx: 'object',\n  remediations: 'array',\n  dynamicRefreshInterval: 'number',\n  deviceFingerprint: 'string',\n  hooks: 'object' // instance of models/Hooks\n};\nconst derived = {\n  authenticatorProfile: {\n    deps: ['currentAuthenticator', 'currentAuthenticatorEnrollment'],\n    fn: function (currentAuthenticator = {\n      profile: undefined\n    }, currentAuthenticatorEnrollment = {\n      profile: undefined\n    }) {\n      return currentAuthenticator.profile || currentAuthenticatorEnrollment.profile || {};\n    }\n  },\n  authenticatorKey: {\n    deps: ['currentAuthenticator', 'currentAuthenticatorEnrollment'],\n    fn: function (currentAuthenticator = {\n      key: undefined\n    }, currentAuthenticatorEnrollment = {\n      key: undefined\n    }) {\n      return currentAuthenticator.key || currentAuthenticatorEnrollment.key || '';\n    }\n  },\n  authenticatorMethodType: {\n    deps: ['currentAuthenticator', 'currentAuthenticatorEnrollment'],\n    fn: function (currentAuthenticator = {\n      methods: undefined\n    }, currentAuthenticatorEnrollment = {\n      methods: undefined\n    }) {\n      return currentAuthenticator.methods && currentAuthenticator.methods[0].type || currentAuthenticatorEnrollment.methods && currentAuthenticatorEnrollment.methods[0].type || '';\n    }\n  },\n  isPasswordRecovery: {\n    deps: ['recoveryAuthenticator'],\n    fn: function (recoveryAuthenticator = {\n      type: undefined\n    }) {\n      return (recoveryAuthenticator === null || recoveryAuthenticator === void 0 ? void 0 : recoveryAuthenticator.type) === 'password';\n    }\n  }\n};\nclass AppState extends Model {\n  constructor(attributes, options) {\n    super(attributes, options);\n    this.settings = void 0;\n    this.hooks = void 0;\n    this.settings = options.settings;\n    this.hooks = options.hooks;\n  }\n  get(attributeName) {\n    return Model.prototype.get.call(this, attributeName);\n  }\n  preinitialize(...args) {\n    this.local = local;\n    this.derived = derived;\n    Model.prototype.preinitialize.apply(this, args);\n  }\n  isIdentifierOnlyView() {\n    var _this$get, _this$get$find, _this$get$find$uiSche;\n    return !((_this$get = this.get('remediations')) !== null && _this$get !== void 0 && (_this$get$find = _this$get.find(({\n      name: name\n    }) => name === 'identify')) !== null && _this$get$find !== void 0 && (_this$get$find$uiSche = _this$get$find.uiSchema) !== null && _this$get$find$uiSche !== void 0 && _this$get$find$uiSche.find(({\n      name: name\n    }) => name === 'credentials.passcode'));\n  }\n  hasRemediationObject(formName) {\n    return this.get('idx').neededToProceed.find(remediation => remediation.name === formName);\n  }\n  hasActionObject(actionName) {\n    var _this$get2, _this$get2$actions;\n    return !!((_this$get2 = this.get('idx')) !== null && _this$get2 !== void 0 && (_this$get2$actions = _this$get2.actions) !== null && _this$get2$actions !== void 0 && _this$get2$actions[actionName]);\n  }\n  getRemediationAuthenticationOptions(formName) {\n    const form = this.hasRemediationObject(formName);\n    if (!form) {\n      return [];\n    }\n    const authenticator = form.value.find(value => value.name === 'authenticator');\n    let authenticatorOptions = (authenticator === null || authenticator === void 0 ? void 0 : authenticator.options) || []; // OV is a special case, so process OV options\n\n    authenticatorOptions = [...authenticatorOptions]; //clone it since we are changing it for OV\n\n    createOVOptions(authenticatorOptions);\n    return authenticatorOptions;\n  }\n  getActionByPath(actionPath) {\n    const paths = actionPath.split('.');\n    let targetObject;\n    if (paths.length === 1) {\n      targetObject = this.get('idx').actions;\n    } else {\n      targetObject = this.get(paths.shift());\n    } // Limitation\n    // At the time of writting, action only lives in first level of state objects.\n\n    const actionName = paths.shift();\n    if (targetObject && oktaUnderscore.isFunction(targetObject[actionName])) {\n      return targetObject[actionName];\n    } else {\n      return null;\n    }\n  }\n  getCurrentViewState() {\n    const currentFormName = this.get('currentFormName');\n    if (!currentFormName) {\n      return;\n    } // didn't expect `remediations` is empty. See `setIonResponse`.\n\n    const currentViewState = this.get('remediations').filter(r => r.name === currentFormName)[0];\n    if (!currentViewState) {\n      Logger.error('Panic!!');\n      Logger.error(`\\tCannot find view state for form ${currentFormName}.`);\n      const allFormNames = this.get('remediations').map(r => r.name);\n      Logger.error(`\\tAll available form names: ${allFormNames}`);\n    }\n    return currentViewState;\n  }\n  /**\n   * Returns ui schema of the form field from current view state\n   * @param {string} fieldName\n   * @returns {}\n   */\n\n  getSchemaByName(fieldName) {\n    const currentViewState = this.getCurrentViewState();\n    if (currentViewState) {\n      const uiSchema = currentViewState.uiSchema;\n      return uiSchema.find(({\n        name: name\n      }) => name === fieldName);\n    }\n  }\n  /**\n   * Returns the displayName of the authenticator\n   * @returns {string}\n   */\n\n  getAuthenticatorDisplayName() {\n    const currentAuthenticator = this.get('currentAuthenticator') || {};\n    const currentAuthenticatorEnrollment = this.get('currentAuthenticatorEnrollment') || {}; // For enrollment and certain verification flows, the currentAuthenticator object will be present.\n    // If not, we're likely in a traditional verify/challenge flow.\n\n    return currentAuthenticator.displayName || currentAuthenticatorEnrollment.displayName;\n  }\n  /**\n   * Checks to see if we're in an authenticator challenge flow.\n   * @returns {boolean}\n   */\n\n  isAuthenticatorChallenge() {\n    const currentFormName = this.get('currentFormName');\n    return FORMS_FOR_VERIFICATION.includes(currentFormName);\n  }\n  shouldReRenderView(transformedResponse) {\n    var _transformedResponse$;\n    if (transformedResponse !== null && transformedResponse !== void 0 && (_transformedResponse$ = transformedResponse.idx) !== null && _transformedResponse$ !== void 0 && _transformedResponse$.hasFormError) {\n      return false;\n    }\n    const previousRawState = this.has('idx') ? this.get('idx').rawIdxState : null;\n    const identicalResponse = oktaUnderscore.isEqual(oktaUnderscore.nestedOmit(transformedResponse.idx.rawIdxState, ['expiresAt', 'refresh', 'stateHandle', 'headers']), oktaUnderscore.nestedOmit(previousRawState, ['expiresAt', 'refresh', 'stateHandle', 'headers']));\n    if (identicalResponse) {\n      this.set('dynamicRefreshInterval', this.getRefreshInterval(transformedResponse));\n    }\n    return this._isReRenderRequired(identicalResponse, transformedResponse, previousRawState);\n  }\n  getRefreshInterval(transformedResponse) {\n    var _transformedResponse$2, _transformedResponse$3, _transformedResponse$4, _transformedResponse$5;\n\n    // Only polling refresh interval has changed in the response,\n    // make sure to update the correct poll view's refresh value\n    const currentFormName = this.get('currentFormName');\n    const currentViewState = transformedResponse.remediations.filter(r => r.name === currentFormName)[0]; // Get new refresh interval for either: remediations, authenticator, or authenticator enrollment\n\n    return currentViewState.refresh || ((_transformedResponse$2 = transformedResponse.currentAuthenticatorEnrollment) === null || _transformedResponse$2 === void 0 ? void 0 : (_transformedResponse$3 = _transformedResponse$2.poll) === null || _transformedResponse$3 === void 0 ? void 0 : _transformedResponse$3.refresh) || ((_transformedResponse$4 = transformedResponse.currentAuthenticator) === null || _transformedResponse$4 === void 0 ? void 0 : (_transformedResponse$5 = _transformedResponse$4.poll) === null || _transformedResponse$5 === void 0 ? void 0 : _transformedResponse$5.refresh);\n  } // Sign Out link will be displayed in the footer of a form, unless:\n  // - widget configuration set hideSignOutLinkInMFA or mfaOnlyFlow to true\n  // - cancel remediation form is not present in the response\n  // - form is part of our list FORMS_WITHOUT_SIGNOUT\n\n  shouldShowSignOutLinkInCurrentForm(hideSignOutLinkInMFA) {\n    const idxActions = this.get('idx') && this.get('idx').actions;\n    const currentFormName = this.get('currentFormName');\n    return !hideSignOutLinkInMFA && oktaUnderscore.isFunction(idxActions === null || idxActions === void 0 ? void 0 : idxActions.cancel) && !FORMS_WITHOUT_SIGNOUT.includes(currentFormName);\n  }\n  containsMessageWithI18nKey(keys) {\n    if (!Array.isArray(keys)) {\n      keys = [keys];\n    }\n    const messagesObjs = this.get('messages');\n    return messagesObjs && Array.isArray(messagesObjs.value) && messagesObjs.value.some(messagesObj => {\n      var _messagesObj$i18n;\n      return oktaUnderscore.contains(keys, (_messagesObj$i18n = messagesObj.i18n) === null || _messagesObj$i18n === void 0 ? void 0 : _messagesObj$i18n.key);\n    });\n  }\n  containsMessageStartingWithI18nKey(keySubStr) {\n    const messagesObjs = this.get('messages');\n    return messagesObjs && Array.isArray(messagesObjs.value) && messagesObjs.value.some(messagesObj => {\n      var _messagesObj$i18n2;\n      return (_messagesObj$i18n2 = messagesObj.i18n) === null || _messagesObj$i18n2 === void 0 ? void 0 : _messagesObj$i18n2.key.startsWith(keySubStr);\n    });\n  }\n  clearAppStateCache() {\n    // clear appState before setting new values\n    const attrs = {};\n    for (const key in this.attributes) {\n      if (key !== 'currentFormName') {\n        attrs[key] = void 0;\n      }\n    }\n    this.set(attrs, Object.assign({}, {\n      unset: true,\n      silent: true\n    })); // clear cache for derived props.\n\n    this.trigger('cache:clear');\n  }\n  setIonResponse(transformedResponse) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const doRerender = _this.shouldReRenderView(transformedResponse);\n      _this.clearAppStateCache(); // set new app state properties\n\n      _this.set(transformedResponse);\n      if (doRerender) {\n        var _this$hooks;\n\n        // `currentFormName` is default to first form of remediations or nothing.\n        let currentFormName = null;\n        if (!oktaUnderscore.isEmpty(transformedResponse.remediations)) {\n          currentFormName = transformedResponse.remediations[0].name;\n        } else {\n          Logger.error('Panic!!');\n          Logger.error('\\tNo remediation found.');\n          Logger.error('\\tHere is the entire response');\n          Logger.error(JSON.stringify(transformedResponse, null, 2));\n        }\n        const hook = (_this$hooks = _this.hooks) === null || _this$hooks === void 0 ? void 0 : _this$hooks.getHook(currentFormName); // may be undefined\n\n        yield executeHooksBefore(hook);\n        _this.unset('currentFormName', {\n          silent: true\n        }); // make sure change `currentFormName` is last step.\n        // change `currentFormName` will re-render FormController,\n        // which may depend on other derived properties hence\n        // those derived properties must be re-computed before\n        // re-rendering controller.\n\n        _this.set({\n          currentFormName: currentFormName\n        });\n        yield executeHooksAfter(hook);\n      }\n    })();\n  }\n  setNonIdxError(error) {\n    this.set('remediations', [{\n      name: FORMS.TERMINAL\n    }]);\n    this.set('messages', {\n      value: [{\n        message: error.errorDetails.errorSummary,\n        class: 'ERROR'\n      }]\n    });\n    this.set('currentFormName', FORMS.TERMINAL);\n  }\n  getUser() {\n    return this.get('user');\n  }\n  _isReRenderRequired(identicalResponse, transformedResponse, previousRawState) {\n    var _this$get3;\n    let reRender = true;\n    const isPreviousStateError = (_this$get3 = this.get('idx')) === null || _this$get3 === void 0 ? void 0 : _this$get3.hasFormError;\n    if (isPreviousStateError && this._isChallengeAuthenticatorPoll(transformedResponse, previousRawState)) {\n      reRender = false;\n    }\n    if (identicalResponse) {\n      /**\n       * returns false: When new response is same as last.\n       * usually happens during polling when pipeline doesn't proceed to next step.\n       * expiresAt will be different for each response, hence compare objects without that property\n       */\n      reRender = false;\n      if (this.get('currentFormName') === 'poll') {\n        /**\n         * returns true: We want to force reRender when currentForm is poll because request has to reinitiate\n         * based on new refresh and UI has to reflect new timer.\n         * We dont technical poll here we just make a request after the specified refresh time each time\n         * we get a new response.\n         */\n        reRender = true;\n      } else if (FORMS_WITH_STATIC_BACK_LINK.includes(this.get('currentFormName'))) {\n        /**\n         * returns true: We want to force reRender if you go back to selection screen from challenge or enroll screen\n         * and re-select the same authenticator for challenge. In this case also new response will be identical\n         * to the old response.\n         */\n        reRender = true;\n      } else if (this.containsMessageWithI18nKey(UNKNOWN_USER_I8N_KEY)) {\n        /**\n         * Need to re-render or else form will be stuck in saving mode.\n         * This message is a form warning that can result in identical responses if the user enters the same\n         * username as the one in the last message warning.\n         */\n        reRender = true;\n      }\n    }\n    return reRender;\n  }\n  /**\n   * This is to account for the edge case introduced by this issue: OKTA-419210. With the current idx remediations,\n   * there's no good way to generalize this as the backend handles the authenticators for phone, sms and \n   * email differently. Although not ideal, we have to keep this check in for now until we find a better solution.\n   */\n\n  _isChallengeAuthenticatorPoll(transformedResponse, previousRawState) {\n    var _this$get4;\n    const isSameExceptMessages = oktaUnderscore.isEqual(oktaUnderscore.nestedOmit(transformedResponse.idx.rawIdxState, ['expiresAt', 'refresh', 'stateHandle', 'headers']), oktaUnderscore.nestedOmit(previousRawState, ['expiresAt', 'refresh', 'stateHandle', 'messages', 'headers']));\n    const isChallengeAuthenticator = this.get('currentFormName') === 'challenge-authenticator';\n    const isCurrentAuthenticatorEmail = ((_this$get4 = this.get('currentAuthenticatorEnrollment')) === null || _this$get4 === void 0 ? void 0 : _this$get4.key) === AUTHENTICATOR_KEY.EMAIL;\n    return isSameExceptMessages && isChallengeAuthenticator && isCurrentAuthenticatorEmail;\n  }\n}\nexport { AppState as default };","map":{"version":3,"names":["oktaUnderscore","Model","Logger","FORMS_FOR_VERIFICATION","FORMS_WITHOUT_SIGNOUT","FORMS","FORMS_WITH_STATIC_BACK_LINK","AUTHENTICATOR_KEY","createOVOptions","executeHooksBefore","executeHooksAfter","UNKNOWN_USER_I8N_KEY","local","user","currentFormName","idx","remediations","dynamicRefreshInterval","deviceFingerprint","hooks","derived","authenticatorProfile","deps","fn","currentAuthenticator","profile","undefined","currentAuthenticatorEnrollment","authenticatorKey","key","authenticatorMethodType","methods","type","isPasswordRecovery","recoveryAuthenticator","AppState","constructor","attributes","options","settings","get","attributeName","prototype","call","preinitialize","args","apply","isIdentifierOnlyView","_this$get","_this$get$find","_this$get$find$uiSche","find","name","uiSchema","hasRemediationObject","formName","neededToProceed","remediation","hasActionObject","actionName","_this$get2","_this$get2$actions","actions","getRemediationAuthenticationOptions","form","authenticator","value","authenticatorOptions","getActionByPath","actionPath","paths","split","targetObject","length","shift","isFunction","getCurrentViewState","currentViewState","filter","r","error","allFormNames","map","getSchemaByName","fieldName","getAuthenticatorDisplayName","displayName","isAuthenticatorChallenge","includes","shouldReRenderView","transformedResponse","_transformedResponse$","hasFormError","previousRawState","has","rawIdxState","identicalResponse","isEqual","nestedOmit","set","getRefreshInterval","_isReRenderRequired","_transformedResponse$2","_transformedResponse$3","_transformedResponse$4","_transformedResponse$5","refresh","poll","shouldShowSignOutLinkInCurrentForm","hideSignOutLinkInMFA","idxActions","cancel","containsMessageWithI18nKey","keys","Array","isArray","messagesObjs","some","messagesObj","_messagesObj$i18n","contains","i18n","containsMessageStartingWithI18nKey","keySubStr","_messagesObj$i18n2","startsWith","clearAppStateCache","attrs","Object","assign","unset","silent","trigger","setIonResponse","_this","_asyncToGenerator","doRerender","_this$hooks","isEmpty","JSON","stringify","hook","getHook","setNonIdxError","TERMINAL","message","errorDetails","errorSummary","class","getUser","_this$get3","reRender","isPreviousStateError","_isChallengeAuthenticatorPoll","_this$get4","isSameExceptMessages","isChallengeAuthenticator","isCurrentAuthenticatorEmail","EMAIL","default"],"sources":["/Users/tushar/Desktop/fullstack-angular-and-springboot-master/source-code/ecommerce-project-release-3.0/09-security-order-history-secure-backend-and-frontend/03-frontend/angular-ecommerce/node_modules/@okta/okta-signin-widget/dist/esm/src/v2/models/AppState.js"],"sourcesContent":["import '../../../packages/@okta/courage-dist/esm/src/CourageForSigninWidget.js';\nimport '../../../packages/@okta/courage-dist/esm/lib/handlebars/dist/cjs/handlebars.runtime.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/handle-url.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-base64.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-i18n.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-img.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-markdown.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/util/handlebars/helper-xsrfTokenInput.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/framework/Model.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/vendor/lib/backbone.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/util/jquery-wrapper.js';\nimport oktaUnderscore from '../../../packages/@okta/courage-dist/esm/src/courage/util/underscore-wrapper.js';\nimport Model from '../../../packages/@okta/courage-dist/esm/src/courage/models/Model.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/models/BaseModel.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/framework/View.js';\nimport '../../../packages/@okta/courage-dist/esm/src/courage/views/Backbone.ListView.js';\nimport Logger from '../../util/Logger.js';\nimport { FORMS_FOR_VERIFICATION, FORMS_WITHOUT_SIGNOUT, FORMS, FORMS_WITH_STATIC_BACK_LINK, AUTHENTICATOR_KEY } from '../ion/RemediationConstants.js';\nimport { createOVOptions } from '../ion/ui-schema/ion-object-handler.js';\nimport '../mixins/mixins.js';\nimport { executeHooksBefore, executeHooksAfter } from '../../util/Hooks.js';\n\n/*!\n * Copyright (c) 2020, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nconst UNKNOWN_USER_I8N_KEY = \"idx.unknown.user\";\n/**\n * Keep track of stateMachine with this special model. Similar to `src/models/AppState.js`\n */\n\nconst local = {\n  user: 'object',\n  // optional\n  currentFormName: 'string',\n  idx: 'object',\n  remediations: 'array',\n  dynamicRefreshInterval: 'number',\n  deviceFingerprint: 'string',\n  hooks: 'object' // instance of models/Hooks\n\n};\nconst derived = {\n  authenticatorProfile: {\n    deps: ['currentAuthenticator', 'currentAuthenticatorEnrollment'],\n    fn: function (currentAuthenticator = {\n      profile: undefined\n    }, currentAuthenticatorEnrollment = {\n      profile: undefined\n    }) {\n      return currentAuthenticator.profile || currentAuthenticatorEnrollment.profile || {};\n    }\n  },\n  authenticatorKey: {\n    deps: ['currentAuthenticator', 'currentAuthenticatorEnrollment'],\n    fn: function (currentAuthenticator = {\n      key: undefined\n    }, currentAuthenticatorEnrollment = {\n      key: undefined\n    }) {\n      return currentAuthenticator.key || currentAuthenticatorEnrollment.key || '';\n    }\n  },\n  authenticatorMethodType: {\n    deps: ['currentAuthenticator', 'currentAuthenticatorEnrollment'],\n    fn: function (currentAuthenticator = {\n      methods: undefined\n    }, currentAuthenticatorEnrollment = {\n      methods: undefined\n    }) {\n      return currentAuthenticator.methods && currentAuthenticator.methods[0].type || currentAuthenticatorEnrollment.methods && currentAuthenticatorEnrollment.methods[0].type || '';\n    }\n  },\n  isPasswordRecovery: {\n    deps: ['recoveryAuthenticator'],\n    fn: function (recoveryAuthenticator = {\n      type: undefined\n    }) {\n      return (recoveryAuthenticator === null || recoveryAuthenticator === void 0 ? void 0 : recoveryAuthenticator.type) === 'password';\n    }\n  }\n};\nclass AppState extends Model {\n  constructor(attributes, options) {\n    super(attributes, options);\n    this.settings = void 0;\n    this.hooks = void 0;\n    this.settings = options.settings;\n    this.hooks = options.hooks;\n  }\n\n  get(attributeName) {\n    return Model.prototype.get.call(this, attributeName);\n  }\n\n  preinitialize(...args) {\n    this.local = local;\n    this.derived = derived;\n    Model.prototype.preinitialize.apply(this, args);\n  }\n\n  isIdentifierOnlyView() {\n    var _this$get, _this$get$find, _this$get$find$uiSche;\n\n    return !((_this$get = this.get('remediations')) !== null && _this$get !== void 0 && (_this$get$find = _this$get.find(({\n      name: name\n    }) => name === 'identify')) !== null && _this$get$find !== void 0 && (_this$get$find$uiSche = _this$get$find.uiSchema) !== null && _this$get$find$uiSche !== void 0 && _this$get$find$uiSche.find(({\n      name: name\n    }) => name === 'credentials.passcode'));\n  }\n\n  hasRemediationObject(formName) {\n    return this.get('idx').neededToProceed.find(remediation => remediation.name === formName);\n  }\n\n  hasActionObject(actionName) {\n    var _this$get2, _this$get2$actions;\n\n    return !!((_this$get2 = this.get('idx')) !== null && _this$get2 !== void 0 && (_this$get2$actions = _this$get2.actions) !== null && _this$get2$actions !== void 0 && _this$get2$actions[actionName]);\n  }\n\n  getRemediationAuthenticationOptions(formName) {\n    const form = this.hasRemediationObject(formName);\n\n    if (!form) {\n      return [];\n    }\n\n    const authenticator = form.value.find(value => value.name === 'authenticator');\n    let authenticatorOptions = (authenticator === null || authenticator === void 0 ? void 0 : authenticator.options) || []; // OV is a special case, so process OV options\n\n    authenticatorOptions = [...authenticatorOptions]; //clone it since we are changing it for OV\n\n    createOVOptions(authenticatorOptions);\n    return authenticatorOptions;\n  }\n\n  getActionByPath(actionPath) {\n    const paths = actionPath.split('.');\n    let targetObject;\n\n    if (paths.length === 1) {\n      targetObject = this.get('idx').actions;\n    } else {\n      targetObject = this.get(paths.shift());\n    } // Limitation\n    // At the time of writting, action only lives in first level of state objects.\n\n\n    const actionName = paths.shift();\n\n    if (targetObject && oktaUnderscore.isFunction(targetObject[actionName])) {\n      return targetObject[actionName];\n    } else {\n      return null;\n    }\n  }\n\n  getCurrentViewState() {\n    const currentFormName = this.get('currentFormName');\n\n    if (!currentFormName) {\n      return;\n    } // didn't expect `remediations` is empty. See `setIonResponse`.\n\n\n    const currentViewState = this.get('remediations').filter(r => r.name === currentFormName)[0];\n\n    if (!currentViewState) {\n      Logger.error('Panic!!');\n      Logger.error(`\\tCannot find view state for form ${currentFormName}.`);\n      const allFormNames = this.get('remediations').map(r => r.name);\n      Logger.error(`\\tAll available form names: ${allFormNames}`);\n    }\n\n    return currentViewState;\n  }\n  /**\n   * Returns ui schema of the form field from current view state\n   * @param {string} fieldName\n   * @returns {}\n   */\n\n\n  getSchemaByName(fieldName) {\n    const currentViewState = this.getCurrentViewState();\n\n    if (currentViewState) {\n      const uiSchema = currentViewState.uiSchema;\n      return uiSchema.find(({\n        name: name\n      }) => name === fieldName);\n    }\n  }\n  /**\n   * Returns the displayName of the authenticator\n   * @returns {string}\n   */\n\n\n  getAuthenticatorDisplayName() {\n    const currentAuthenticator = this.get('currentAuthenticator') || {};\n    const currentAuthenticatorEnrollment = this.get('currentAuthenticatorEnrollment') || {}; // For enrollment and certain verification flows, the currentAuthenticator object will be present.\n    // If not, we're likely in a traditional verify/challenge flow.\n\n    return currentAuthenticator.displayName || currentAuthenticatorEnrollment.displayName;\n  }\n  /**\n   * Checks to see if we're in an authenticator challenge flow.\n   * @returns {boolean}\n   */\n\n\n  isAuthenticatorChallenge() {\n    const currentFormName = this.get('currentFormName');\n    return FORMS_FOR_VERIFICATION.includes(currentFormName);\n  }\n\n  shouldReRenderView(transformedResponse) {\n    var _transformedResponse$;\n\n    if (transformedResponse !== null && transformedResponse !== void 0 && (_transformedResponse$ = transformedResponse.idx) !== null && _transformedResponse$ !== void 0 && _transformedResponse$.hasFormError) {\n      return false;\n    }\n\n    const previousRawState = this.has('idx') ? this.get('idx').rawIdxState : null;\n\n    const identicalResponse = oktaUnderscore.isEqual(oktaUnderscore.nestedOmit(transformedResponse.idx.rawIdxState, ['expiresAt', 'refresh', 'stateHandle', 'headers']), oktaUnderscore.nestedOmit(previousRawState, ['expiresAt', 'refresh', 'stateHandle', 'headers']));\n\n    if (identicalResponse) {\n      this.set('dynamicRefreshInterval', this.getRefreshInterval(transformedResponse));\n    }\n\n    return this._isReRenderRequired(identicalResponse, transformedResponse, previousRawState);\n  }\n\n  getRefreshInterval(transformedResponse) {\n    var _transformedResponse$2, _transformedResponse$3, _transformedResponse$4, _transformedResponse$5;\n\n    // Only polling refresh interval has changed in the response,\n    // make sure to update the correct poll view's refresh value\n    const currentFormName = this.get('currentFormName');\n    const currentViewState = transformedResponse.remediations.filter(r => r.name === currentFormName)[0]; // Get new refresh interval for either: remediations, authenticator, or authenticator enrollment\n\n    return currentViewState.refresh || ((_transformedResponse$2 = transformedResponse.currentAuthenticatorEnrollment) === null || _transformedResponse$2 === void 0 ? void 0 : (_transformedResponse$3 = _transformedResponse$2.poll) === null || _transformedResponse$3 === void 0 ? void 0 : _transformedResponse$3.refresh) || ((_transformedResponse$4 = transformedResponse.currentAuthenticator) === null || _transformedResponse$4 === void 0 ? void 0 : (_transformedResponse$5 = _transformedResponse$4.poll) === null || _transformedResponse$5 === void 0 ? void 0 : _transformedResponse$5.refresh);\n  } // Sign Out link will be displayed in the footer of a form, unless:\n  // - widget configuration set hideSignOutLinkInMFA or mfaOnlyFlow to true\n  // - cancel remediation form is not present in the response\n  // - form is part of our list FORMS_WITHOUT_SIGNOUT\n\n\n  shouldShowSignOutLinkInCurrentForm(hideSignOutLinkInMFA) {\n    const idxActions = this.get('idx') && this.get('idx').actions;\n    const currentFormName = this.get('currentFormName');\n    return !hideSignOutLinkInMFA && oktaUnderscore.isFunction(idxActions === null || idxActions === void 0 ? void 0 : idxActions.cancel) && !FORMS_WITHOUT_SIGNOUT.includes(currentFormName);\n  }\n\n  containsMessageWithI18nKey(keys) {\n    if (!Array.isArray(keys)) {\n      keys = [keys];\n    }\n\n    const messagesObjs = this.get('messages');\n    return messagesObjs && Array.isArray(messagesObjs.value) && messagesObjs.value.some(messagesObj => {\n      var _messagesObj$i18n;\n\n      return oktaUnderscore.contains(keys, (_messagesObj$i18n = messagesObj.i18n) === null || _messagesObj$i18n === void 0 ? void 0 : _messagesObj$i18n.key);\n    });\n  }\n\n  containsMessageStartingWithI18nKey(keySubStr) {\n    const messagesObjs = this.get('messages');\n    return messagesObjs && Array.isArray(messagesObjs.value) && messagesObjs.value.some(messagesObj => {\n      var _messagesObj$i18n2;\n\n      return (_messagesObj$i18n2 = messagesObj.i18n) === null || _messagesObj$i18n2 === void 0 ? void 0 : _messagesObj$i18n2.key.startsWith(keySubStr);\n    });\n  }\n\n  clearAppStateCache() {\n    // clear appState before setting new values\n    const attrs = {};\n\n    for (const key in this.attributes) {\n      if (key !== 'currentFormName') {\n        attrs[key] = void 0;\n      }\n    }\n\n    this.set(attrs, Object.assign({}, {\n      unset: true,\n      silent: true\n    })); // clear cache for derived props.\n\n    this.trigger('cache:clear');\n  }\n\n  async setIonResponse(transformedResponse) {\n    const doRerender = this.shouldReRenderView(transformedResponse);\n    this.clearAppStateCache(); // set new app state properties\n\n    this.set(transformedResponse);\n\n    if (doRerender) {\n      var _this$hooks;\n\n      // `currentFormName` is default to first form of remediations or nothing.\n      let currentFormName = null;\n\n      if (!oktaUnderscore.isEmpty(transformedResponse.remediations)) {\n        currentFormName = transformedResponse.remediations[0].name;\n      } else {\n        Logger.error('Panic!!');\n        Logger.error('\\tNo remediation found.');\n        Logger.error('\\tHere is the entire response');\n        Logger.error(JSON.stringify(transformedResponse, null, 2));\n      }\n\n      const hook = (_this$hooks = this.hooks) === null || _this$hooks === void 0 ? void 0 : _this$hooks.getHook(currentFormName); // may be undefined\n\n      await executeHooksBefore(hook);\n      this.unset('currentFormName', {\n        silent: true\n      }); // make sure change `currentFormName` is last step.\n      // change `currentFormName` will re-render FormController,\n      // which may depend on other derived properties hence\n      // those derived properties must be re-computed before\n      // re-rendering controller.\n\n      this.set({\n        currentFormName: currentFormName\n      });\n      await executeHooksAfter(hook);\n    }\n  }\n\n  setNonIdxError(error) {\n    this.set('remediations', [{\n      name: FORMS.TERMINAL\n    }]);\n    this.set('messages', {\n      value: [{\n        message: error.errorDetails.errorSummary,\n        class: 'ERROR'\n      }]\n    });\n    this.set('currentFormName', FORMS.TERMINAL);\n  }\n\n  getUser() {\n    return this.get('user');\n  }\n\n  _isReRenderRequired(identicalResponse, transformedResponse, previousRawState) {\n    var _this$get3;\n\n    let reRender = true;\n    const isPreviousStateError = (_this$get3 = this.get('idx')) === null || _this$get3 === void 0 ? void 0 : _this$get3.hasFormError;\n\n    if (isPreviousStateError && this._isChallengeAuthenticatorPoll(transformedResponse, previousRawState)) {\n      reRender = false;\n    }\n\n    if (identicalResponse) {\n      /**\n       * returns false: When new response is same as last.\n       * usually happens during polling when pipeline doesn't proceed to next step.\n       * expiresAt will be different for each response, hence compare objects without that property\n       */\n      reRender = false;\n\n      if (this.get('currentFormName') === 'poll') {\n        /**\n         * returns true: We want to force reRender when currentForm is poll because request has to reinitiate\n         * based on new refresh and UI has to reflect new timer.\n         * We dont technical poll here we just make a request after the specified refresh time each time\n         * we get a new response.\n         */\n        reRender = true;\n      } else if (FORMS_WITH_STATIC_BACK_LINK.includes(this.get('currentFormName'))) {\n        /**\n         * returns true: We want to force reRender if you go back to selection screen from challenge or enroll screen\n         * and re-select the same authenticator for challenge. In this case also new response will be identical\n         * to the old response.\n         */\n        reRender = true;\n      } else if (this.containsMessageWithI18nKey(UNKNOWN_USER_I8N_KEY)) {\n        /**\n         * Need to re-render or else form will be stuck in saving mode.\n         * This message is a form warning that can result in identical responses if the user enters the same\n         * username as the one in the last message warning.\n         */\n        reRender = true;\n      }\n    }\n\n    return reRender;\n  }\n  /**\n   * This is to account for the edge case introduced by this issue: OKTA-419210. With the current idx remediations,\n   * there's no good way to generalize this as the backend handles the authenticators for phone, sms and \n   * email differently. Although not ideal, we have to keep this check in for now until we find a better solution.\n   */\n\n\n  _isChallengeAuthenticatorPoll(transformedResponse, previousRawState) {\n    var _this$get4;\n\n    const isSameExceptMessages = oktaUnderscore.isEqual(oktaUnderscore.nestedOmit(transformedResponse.idx.rawIdxState, ['expiresAt', 'refresh', 'stateHandle', 'headers']), oktaUnderscore.nestedOmit(previousRawState, ['expiresAt', 'refresh', 'stateHandle', 'messages', 'headers']));\n\n    const isChallengeAuthenticator = this.get('currentFormName') === 'challenge-authenticator';\n    const isCurrentAuthenticatorEmail = ((_this$get4 = this.get('currentAuthenticatorEnrollment')) === null || _this$get4 === void 0 ? void 0 : _this$get4.key) === AUTHENTICATOR_KEY.EMAIL;\n    return isSameExceptMessages && isChallengeAuthenticator && isCurrentAuthenticatorEmail;\n  }\n\n}\n\nexport { AppState as default };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}
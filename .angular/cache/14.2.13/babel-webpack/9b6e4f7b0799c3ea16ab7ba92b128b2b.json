{"ast":null,"code":"import _asyncToGenerator from \"/Users/tushar/Desktop/fullstack-angular-and-springboot-master/source-code/ecommerce-project-release-3.0/09-security-order-history-secure-backend-and-frontend/03-frontend/angular-ecommerce/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * \n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { interact } from './interact.js';\nimport { introspect } from './introspect.js';\nimport { remediate } from './remediate.js';\nimport { IdxStatus } from './types/api.js';\nimport './remediators/EnrollAuthenticator.js';\nimport './remediators/EnrollPoll.js';\nimport './remediators/SelectEnrollmentChannel.js';\nimport './remediators/EnrollmentChannelData.js';\nimport './remediators/ChallengeAuthenticator.js';\nimport './remediators/ChallengePoll.js';\nimport './remediators/ResetAuthenticator.js';\nimport './remediators/EnrollProfile.js';\nimport './remediators/Identify.js';\nimport './remediators/ReEnrollAuthenticator.js';\nimport './remediators/RedirectIdp.js';\nimport './remediators/SelectAuthenticatorAuthenticate.js';\nimport './remediators/SelectAuthenticatorEnroll.js';\nimport './remediators/SelectAuthenticatorUnlockAccount.js';\nimport './remediators/SelectEnrollProfile.js';\nimport './remediators/AuthenticatorVerificationData.js';\nimport './remediators/AuthenticatorEnrollmentData.js';\nimport './remediators/Skip.js';\nimport { getFlowSpecification } from './flow/FlowSpecification.js';\nimport '../myaccount/types.js';\nimport { isIdxResponse } from './types/idx-js.js';\nimport { saveTransactionMeta, getSavedTransactionMeta } from './transactionMeta.js';\nimport { getEnabledFeatures, getAvailableSteps, getMessagesFromResponse, isTerminalResponse } from './util.js';\nfunction initializeValues(options) {\n  const knownOptions = ['flow', 'remediators', 'actions', 'withCredentials', 'step', 'useGenericRemediator', 'exchangeCodeForTokens', 'shouldProceedWithEmailAuthenticator'];\n  const values = Object.assign({}, options);\n  knownOptions.forEach(option => {\n    delete values[option];\n  });\n  return values;\n}\nfunction initializeData(authClient, data) {\n  let {\n    options\n  } = data;\n  options = Object.assign(Object.assign({}, authClient.options.idx), options);\n  let {\n    flow,\n    withCredentials,\n    remediators,\n    actions\n  } = options;\n  const status = IdxStatus.PENDING;\n  flow = flow || authClient.idx.getFlow() || 'default';\n  if (flow) {\n    authClient.idx.setFlow(flow);\n    const flowSpec = getFlowSpecification(authClient, flow);\n    withCredentials = typeof withCredentials !== 'undefined' ? withCredentials : flowSpec.withCredentials;\n    remediators = remediators || flowSpec.remediators;\n    actions = actions || flowSpec.actions;\n  }\n  return Object.assign(Object.assign({}, data), {\n    options: Object.assign(Object.assign({}, options), {\n      flow,\n      withCredentials,\n      remediators,\n      actions\n    }),\n    status\n  });\n}\nfunction getDataFromIntrospect(_x, _x2) {\n  return _getDataFromIntrospect.apply(this, arguments);\n}\nfunction _getDataFromIntrospect() {\n  _getDataFromIntrospect = _asyncToGenerator(function* (authClient, data) {\n    const {\n      options\n    } = data;\n    const {\n      stateHandle,\n      withCredentials,\n      version,\n      state,\n      scopes,\n      recoveryToken,\n      activationToken,\n      maxAge,\n      nonce\n    } = options;\n    let idxResponse;\n    let meta = getSavedTransactionMeta(authClient, {\n      state,\n      recoveryToken,\n      activationToken\n    });\n    if (stateHandle) {\n      idxResponse = yield introspect(authClient, {\n        withCredentials,\n        version,\n        stateHandle\n      });\n    } else {\n      let interactionHandle = meta === null || meta === void 0 ? void 0 : meta.interactionHandle;\n      if (!interactionHandle) {\n        authClient.transactionManager.clear();\n        const interactResponse = yield interact(authClient, {\n          withCredentials,\n          state,\n          scopes,\n          activationToken,\n          recoveryToken,\n          maxAge,\n          nonce\n        });\n        interactionHandle = interactResponse.interactionHandle;\n        meta = interactResponse.meta;\n      }\n      idxResponse = yield introspect(authClient, {\n        withCredentials,\n        version,\n        interactionHandle\n      });\n    }\n    return Object.assign(Object.assign({}, data), {\n      idxResponse,\n      meta\n    });\n  });\n  return _getDataFromIntrospect.apply(this, arguments);\n}\nfunction getDataFromRemediate(_x3, _x4) {\n  return _getDataFromRemediate.apply(this, arguments);\n}\nfunction _getDataFromRemediate() {\n  _getDataFromRemediate = _asyncToGenerator(function* (authClient, data) {\n    let {\n      idxResponse,\n      options,\n      values\n    } = data;\n    const {\n      autoRemediate,\n      remediators,\n      actions,\n      flow,\n      step,\n      shouldProceedWithEmailAuthenticator,\n      useGenericRemediator\n    } = options;\n    const shouldRemediate = autoRemediate !== false && (remediators || actions || step);\n    if (!shouldRemediate) {\n      return data;\n    }\n    values = Object.assign(Object.assign({}, values), {\n      stateHandle: idxResponse.rawIdxState.stateHandle\n    });\n    const {\n      idxResponse: idxResponseFromRemediation,\n      nextStep,\n      canceled\n    } = yield remediate(authClient, idxResponse, values, {\n      remediators,\n      actions,\n      flow,\n      step,\n      shouldProceedWithEmailAuthenticator,\n      useGenericRemediator\n    });\n    idxResponse = idxResponseFromRemediation;\n    return Object.assign(Object.assign({}, data), {\n      idxResponse,\n      nextStep,\n      canceled\n    });\n  });\n  return _getDataFromRemediate.apply(this, arguments);\n}\nfunction getTokens(_x5, _x6) {\n  return _getTokens.apply(this, arguments);\n}\nfunction _getTokens() {\n  _getTokens = _asyncToGenerator(function* (authClient, data) {\n    let {\n      meta,\n      idxResponse\n    } = data;\n    const {\n      interactionCode\n    } = idxResponse;\n    const {\n      clientId,\n      codeVerifier,\n      ignoreSignature,\n      redirectUri,\n      urls,\n      scopes\n    } = meta;\n    const tokenResponse = yield authClient.token.exchangeCodeForTokens({\n      interactionCode,\n      clientId,\n      codeVerifier,\n      ignoreSignature,\n      redirectUri,\n      scopes\n    }, urls);\n    return tokenResponse.tokens;\n  });\n  return _getTokens.apply(this, arguments);\n}\nfunction finalizeData(_x7, _x8) {\n  return _finalizeData.apply(this, arguments);\n}\nfunction _finalizeData() {\n  _finalizeData = _asyncToGenerator(function* (authClient, data) {\n    let {\n      options,\n      idxResponse,\n      canceled,\n      status\n    } = data;\n    const {\n      exchangeCodeForTokens\n    } = options;\n    let shouldSaveResponse = false;\n    let shouldClearTransaction = false;\n    let clearSharedStorage = true;\n    let interactionCode;\n    let tokens;\n    let enabledFeatures;\n    let availableSteps;\n    let messages;\n    let terminal;\n    if (idxResponse) {\n      shouldSaveResponse = !!(idxResponse.requestDidSucceed || idxResponse.stepUp);\n      enabledFeatures = getEnabledFeatures(idxResponse);\n      availableSteps = getAvailableSteps(authClient, idxResponse, options.useGenericRemediator);\n      messages = getMessagesFromResponse(idxResponse, options);\n      terminal = isTerminalResponse(idxResponse);\n    }\n    if (terminal) {\n      status = IdxStatus.TERMINAL;\n      const hasActions = Object.keys(idxResponse.actions).length > 0;\n      const hasErrors = !!messages.find(msg => msg.class === 'ERROR');\n      const isTerminalSuccess = !hasActions && !hasErrors && idxResponse.requestDidSucceed === true;\n      if (isTerminalSuccess) {\n        shouldClearTransaction = true;\n      } else {\n        shouldSaveResponse = shouldSaveResponse && hasActions;\n      }\n      clearSharedStorage = false;\n    } else if (canceled) {\n      status = IdxStatus.CANCELED;\n      shouldClearTransaction = true;\n    } else if (idxResponse === null || idxResponse === void 0 ? void 0 : idxResponse.interactionCode) {\n      interactionCode = idxResponse.interactionCode;\n      if (exchangeCodeForTokens === false) {\n        status = IdxStatus.SUCCESS;\n        shouldClearTransaction = false;\n      } else {\n        tokens = yield getTokens(authClient, data);\n        status = IdxStatus.SUCCESS;\n        shouldClearTransaction = true;\n      }\n    }\n    return Object.assign(Object.assign({}, data), {\n      status,\n      interactionCode,\n      tokens,\n      shouldSaveResponse,\n      shouldClearTransaction,\n      clearSharedStorage,\n      enabledFeatures,\n      availableSteps,\n      messages,\n      terminal\n    });\n  });\n  return _finalizeData.apply(this, arguments);\n}\nfunction handleError(err, data) {\n  let {\n    error,\n    status,\n    shouldClearTransaction\n  } = data;\n  if (isIdxResponse(err)) {\n    error = err;\n    status = IdxStatus.FAILURE;\n    shouldClearTransaction = true;\n  } else {\n    throw err;\n  }\n  return Object.assign(Object.assign({}, data), {\n    error,\n    status,\n    shouldClearTransaction\n  });\n}\nfunction run(_x9) {\n  return _run.apply(this, arguments);\n}\nfunction _run() {\n  _run = _asyncToGenerator(function* (authClient, options = {}) {\n    var _a;\n    let data = {\n      options,\n      values: initializeValues(options)\n    };\n    data = initializeData(authClient, data);\n    try {\n      data = yield getDataFromIntrospect(authClient, data);\n      data = yield getDataFromRemediate(authClient, data);\n    } catch (err) {\n      data = handleError(err, data);\n    }\n    data = yield finalizeData(authClient, data);\n    const {\n      idxResponse,\n      meta,\n      shouldSaveResponse,\n      shouldClearTransaction,\n      clearSharedStorage,\n      status,\n      enabledFeatures,\n      availableSteps,\n      tokens,\n      nextStep,\n      messages,\n      error,\n      interactionCode\n    } = data;\n    if (shouldClearTransaction) {\n      authClient.transactionManager.clear({\n        clearSharedStorage\n      });\n    } else {\n      saveTransactionMeta(authClient, Object.assign({}, meta));\n      if (shouldSaveResponse) {\n        const {\n          rawIdxState: rawIdxResponse,\n          requestDidSucceed\n        } = idxResponse;\n        authClient.transactionManager.saveIdxResponse({\n          rawIdxResponse,\n          requestDidSucceed,\n          stateHandle: (_a = idxResponse.context) === null || _a === void 0 ? void 0 : _a.stateHandle,\n          interactionHandle: meta === null || meta === void 0 ? void 0 : meta.interactionHandle\n        });\n      }\n    }\n    const {\n      actions,\n      context,\n      neededToProceed,\n      proceed,\n      rawIdxState,\n      requestDidSucceed,\n      stepUp\n    } = idxResponse || {};\n    return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({\n      status: status\n    }, meta && {\n      meta\n    }), enabledFeatures && {\n      enabledFeatures\n    }), availableSteps && {\n      availableSteps\n    }), tokens && {\n      tokens\n    }), nextStep && {\n      nextStep\n    }), messages && messages.length && {\n      messages\n    }), error && {\n      error\n    }), stepUp && {\n      stepUp\n    }), {\n      interactionCode,\n      actions: actions,\n      context: context,\n      neededToProceed: neededToProceed,\n      proceed: proceed,\n      rawIdxState: rawIdxState,\n      requestDidSucceed\n    });\n  });\n  return _run.apply(this, arguments);\n}\nexport { run };","map":{"version":3,"names":["interact","introspect","remediate","IdxStatus","getFlowSpecification","isIdxResponse","saveTransactionMeta","getSavedTransactionMeta","getEnabledFeatures","getAvailableSteps","getMessagesFromResponse","isTerminalResponse","initializeValues","options","knownOptions","values","Object","assign","forEach","option","initializeData","authClient","data","idx","flow","withCredentials","remediators","actions","status","PENDING","getFlow","setFlow","flowSpec","getDataFromIntrospect","_x","_x2","_getDataFromIntrospect","apply","arguments","_asyncToGenerator","stateHandle","version","state","scopes","recoveryToken","activationToken","maxAge","nonce","idxResponse","meta","interactionHandle","transactionManager","clear","interactResponse","getDataFromRemediate","_x3","_x4","_getDataFromRemediate","autoRemediate","step","shouldProceedWithEmailAuthenticator","useGenericRemediator","shouldRemediate","rawIdxState","idxResponseFromRemediation","nextStep","canceled","getTokens","_x5","_x6","_getTokens","interactionCode","clientId","codeVerifier","ignoreSignature","redirectUri","urls","tokenResponse","token","exchangeCodeForTokens","tokens","finalizeData","_x7","_x8","_finalizeData","shouldSaveResponse","shouldClearTransaction","clearSharedStorage","enabledFeatures","availableSteps","messages","terminal","requestDidSucceed","stepUp","TERMINAL","hasActions","keys","length","hasErrors","find","msg","class","isTerminalSuccess","CANCELED","SUCCESS","handleError","err","error","FAILURE","run","_x9","_run","_a","rawIdxResponse","saveIdxResponse","context","neededToProceed","proceed"],"sources":["/Users/tushar/Desktop/fullstack-angular-and-springboot-master/source-code/ecommerce-project-release-3.0/09-security-order-history-secure-backend-and-frontend/03-frontend/angular-ecommerce/node_modules/@okta/okta-auth-js/esm/browser/idx/run.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * \n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { interact } from './interact.js';\nimport { introspect } from './introspect.js';\nimport { remediate } from './remediate.js';\nimport { IdxStatus } from './types/api.js';\nimport './remediators/EnrollAuthenticator.js';\nimport './remediators/EnrollPoll.js';\nimport './remediators/SelectEnrollmentChannel.js';\nimport './remediators/EnrollmentChannelData.js';\nimport './remediators/ChallengeAuthenticator.js';\nimport './remediators/ChallengePoll.js';\nimport './remediators/ResetAuthenticator.js';\nimport './remediators/EnrollProfile.js';\nimport './remediators/Identify.js';\nimport './remediators/ReEnrollAuthenticator.js';\nimport './remediators/RedirectIdp.js';\nimport './remediators/SelectAuthenticatorAuthenticate.js';\nimport './remediators/SelectAuthenticatorEnroll.js';\nimport './remediators/SelectAuthenticatorUnlockAccount.js';\nimport './remediators/SelectEnrollProfile.js';\nimport './remediators/AuthenticatorVerificationData.js';\nimport './remediators/AuthenticatorEnrollmentData.js';\nimport './remediators/Skip.js';\nimport { getFlowSpecification } from './flow/FlowSpecification.js';\nimport '../myaccount/types.js';\nimport { isIdxResponse } from './types/idx-js.js';\nimport { saveTransactionMeta, getSavedTransactionMeta } from './transactionMeta.js';\nimport { getEnabledFeatures, getAvailableSteps, getMessagesFromResponse, isTerminalResponse } from './util.js';\n\nfunction initializeValues(options) {\n    const knownOptions = [\n        'flow',\n        'remediators',\n        'actions',\n        'withCredentials',\n        'step',\n        'useGenericRemediator',\n        'exchangeCodeForTokens',\n        'shouldProceedWithEmailAuthenticator'\n    ];\n    const values = Object.assign({}, options);\n    knownOptions.forEach(option => {\n        delete values[option];\n    });\n    return values;\n}\nfunction initializeData(authClient, data) {\n    let { options } = data;\n    options = Object.assign(Object.assign({}, authClient.options.idx), options);\n    let { flow, withCredentials, remediators, actions, } = options;\n    const status = IdxStatus.PENDING;\n    flow = flow || authClient.idx.getFlow() || 'default';\n    if (flow) {\n        authClient.idx.setFlow(flow);\n        const flowSpec = getFlowSpecification(authClient, flow);\n        withCredentials = (typeof withCredentials !== 'undefined') ? withCredentials : flowSpec.withCredentials;\n        remediators = remediators || flowSpec.remediators;\n        actions = actions || flowSpec.actions;\n    }\n    return Object.assign(Object.assign({}, data), { options: Object.assign(Object.assign({}, options), { flow,\n            withCredentials,\n            remediators,\n            actions }), status });\n}\nasync function getDataFromIntrospect(authClient, data) {\n    const { options } = data;\n    const { stateHandle, withCredentials, version, state, scopes, recoveryToken, activationToken, maxAge, nonce, } = options;\n    let idxResponse;\n    let meta = getSavedTransactionMeta(authClient, { state, recoveryToken, activationToken });\n    if (stateHandle) {\n        idxResponse = await introspect(authClient, { withCredentials, version, stateHandle });\n    }\n    else {\n        let interactionHandle = meta === null || meta === void 0 ? void 0 : meta.interactionHandle;\n        if (!interactionHandle) {\n            authClient.transactionManager.clear();\n            const interactResponse = await interact(authClient, {\n                withCredentials,\n                state,\n                scopes,\n                activationToken,\n                recoveryToken,\n                maxAge,\n                nonce,\n            });\n            interactionHandle = interactResponse.interactionHandle;\n            meta = interactResponse.meta;\n        }\n        idxResponse = await introspect(authClient, { withCredentials, version, interactionHandle });\n    }\n    return Object.assign(Object.assign({}, data), { idxResponse, meta });\n}\nasync function getDataFromRemediate(authClient, data) {\n    let { idxResponse, options, values } = data;\n    const { autoRemediate, remediators, actions, flow, step, shouldProceedWithEmailAuthenticator,\n    useGenericRemediator, } = options;\n    const shouldRemediate = (autoRemediate !== false && (remediators || actions || step));\n    if (!shouldRemediate) {\n        return data;\n    }\n    values = Object.assign(Object.assign({}, values), { stateHandle: idxResponse.rawIdxState.stateHandle });\n    const { idxResponse: idxResponseFromRemediation, nextStep, canceled, } = await remediate(authClient, idxResponse, values, {\n        remediators,\n        actions,\n        flow,\n        step,\n        shouldProceedWithEmailAuthenticator,\n        useGenericRemediator,\n    });\n    idxResponse = idxResponseFromRemediation;\n    return Object.assign(Object.assign({}, data), { idxResponse, nextStep, canceled });\n}\nasync function getTokens(authClient, data) {\n    let { meta, idxResponse } = data;\n    const { interactionCode } = idxResponse;\n    const { clientId, codeVerifier, ignoreSignature, redirectUri, urls, scopes, } = meta;\n    const tokenResponse = await authClient.token.exchangeCodeForTokens({\n        interactionCode,\n        clientId,\n        codeVerifier,\n        ignoreSignature,\n        redirectUri,\n        scopes\n    }, urls);\n    return tokenResponse.tokens;\n}\nasync function finalizeData(authClient, data) {\n    let { options, idxResponse, canceled, status, } = data;\n    const { exchangeCodeForTokens } = options;\n    let shouldSaveResponse = false;\n    let shouldClearTransaction = false;\n    let clearSharedStorage = true;\n    let interactionCode;\n    let tokens;\n    let enabledFeatures;\n    let availableSteps;\n    let messages;\n    let terminal;\n    if (idxResponse) {\n        shouldSaveResponse = !!(idxResponse.requestDidSucceed || idxResponse.stepUp);\n        enabledFeatures = getEnabledFeatures(idxResponse);\n        availableSteps = getAvailableSteps(authClient, idxResponse, options.useGenericRemediator);\n        messages = getMessagesFromResponse(idxResponse, options);\n        terminal = isTerminalResponse(idxResponse);\n    }\n    if (terminal) {\n        status = IdxStatus.TERMINAL;\n        const hasActions = Object.keys(idxResponse.actions).length > 0;\n        const hasErrors = !!messages.find(msg => msg.class === 'ERROR');\n        const isTerminalSuccess = !hasActions && !hasErrors && idxResponse.requestDidSucceed === true;\n        if (isTerminalSuccess) {\n            shouldClearTransaction = true;\n        }\n        else {\n            shouldSaveResponse = shouldSaveResponse && hasActions;\n        }\n        clearSharedStorage = false;\n    }\n    else if (canceled) {\n        status = IdxStatus.CANCELED;\n        shouldClearTransaction = true;\n    }\n    else if (idxResponse === null || idxResponse === void 0 ? void 0 : idxResponse.interactionCode) {\n        interactionCode = idxResponse.interactionCode;\n        if (exchangeCodeForTokens === false) {\n            status = IdxStatus.SUCCESS;\n            shouldClearTransaction = false;\n        }\n        else {\n            tokens = await getTokens(authClient, data);\n            status = IdxStatus.SUCCESS;\n            shouldClearTransaction = true;\n        }\n    }\n    return Object.assign(Object.assign({}, data), { status,\n        interactionCode,\n        tokens,\n        shouldSaveResponse,\n        shouldClearTransaction,\n        clearSharedStorage,\n        enabledFeatures,\n        availableSteps,\n        messages,\n        terminal });\n}\nfunction handleError(err, data) {\n    let { error, status, shouldClearTransaction } = data;\n    if (isIdxResponse(err)) {\n        error = err;\n        status = IdxStatus.FAILURE;\n        shouldClearTransaction = true;\n    }\n    else {\n        throw err;\n    }\n    return Object.assign(Object.assign({}, data), { error, status, shouldClearTransaction });\n}\nasync function run(authClient, options = {}) {\n    var _a;\n    let data = {\n        options,\n        values: initializeValues(options)\n    };\n    data = initializeData(authClient, data);\n    try {\n        data = await getDataFromIntrospect(authClient, data);\n        data = await getDataFromRemediate(authClient, data);\n    }\n    catch (err) {\n        data = handleError(err, data);\n    }\n    data = await finalizeData(authClient, data);\n    const { idxResponse, meta, shouldSaveResponse, shouldClearTransaction, clearSharedStorage, status, enabledFeatures, availableSteps, tokens, nextStep, messages, error, interactionCode } = data;\n    if (shouldClearTransaction) {\n        authClient.transactionManager.clear({ clearSharedStorage });\n    }\n    else {\n        saveTransactionMeta(authClient, Object.assign({}, meta));\n        if (shouldSaveResponse) {\n            const { rawIdxState: rawIdxResponse, requestDidSucceed } = idxResponse;\n            authClient.transactionManager.saveIdxResponse({\n                rawIdxResponse,\n                requestDidSucceed,\n                stateHandle: (_a = idxResponse.context) === null || _a === void 0 ? void 0 : _a.stateHandle,\n                interactionHandle: meta === null || meta === void 0 ? void 0 : meta.interactionHandle\n            });\n        }\n    }\n    const { actions, context, neededToProceed, proceed, rawIdxState, requestDidSucceed, stepUp } = idxResponse || {};\n    return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({ status: status }, (meta && { meta })), (enabledFeatures && { enabledFeatures })), (availableSteps && { availableSteps })), (tokens && { tokens })), (nextStep && { nextStep })), (messages && messages.length && { messages })), (error && { error })), (stepUp && { stepUp })), { interactionCode,\n        actions: actions, context: context, neededToProceed: neededToProceed, proceed: proceed, rawIdxState: rawIdxState, requestDidSucceed });\n}\n\nexport { run };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}